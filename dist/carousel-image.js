!function(t,i){"function"==typeof define&&define.amd?define(["$"],i):"object"==typeof exports?module.exports=i():t.CarouselImage=i(window.Zepto||window.jQuery||$)}(this,function(t){function i(){}return t.fn.CarouselImage=function(n){var e=[];return t(this).each(function(){var s=new i,h=t.extend({target:t(this)},n);s.init(h),e.push(s)}),e},i.prototype={init:function(i){if(this.settings=i,this.index=0,this.container=i.target,this.content=this.container.children().first(),this.timer=i.timer||3e3,this.animate=i.animate||500,this.num=i.num||null,this.list=this.content.children(),this.size=this.list.length,this.repeat=i.repeat||!1,this.repeat){for(var n=0,e=this.list.length;e>n;n++){var s=t(this.list[n]);s.attr("data-index",n)}var h=this.list.first().clone(),o=this.list.last().clone();this.content.append(h),this.content.prepend(o),this.content.css({left:-this.container.width(),position:"absolute"})}else this.content.css({left:0,position:"absolute"});this.setHeightWidth(),this.bindEvent(),this.auto(),this.formatNum()},setHeightWidth:function(){var i=this.settings,n=this,e=new Image;e.src=this.list.first().find("img").attr("src"),n.container.find("img").width(this.container.width()),i.width&&(this.container.width(i.width),this.list.find("img").width(i.width)),this.step=this.container.width(),this.content.width(this.list.length*this.step),i.height?(this.container.height(this.container.height()),this.list.find("img").height(i.height)):t(e).on("load",function(){var t=this.height,i=this.width;n.container.height(n.container.width()/i*t),n.container.find("img").height(n.container.height()),n.content.width((n.list.length+2)*n.step)}),n.content.width((n.list.length+2)*n.step)},touch:function(i,n,e){function s(t){return e.call(this,t)}var h;"function"==typeof n&&(e=n),t(i).on("touchmove",n,function(t){h=!0}).on("touchend",n,function(t){if(t.preventDefault(),!h){var i=e.call(this,t,"touch");i===!1&&(t.preventDefault(),t.stopPropagation())}h=!1}),t(i).on("click",n,s)},bindEvent:function(){var i=this,n={},e=0,s={},h=!1,o={};this.content.on("touchstart",function(s){return n={x:s.changedTouches[0].pageX},2==s.targetTouches.length?(h=!1,!1):(o=t(this).position(),e=n.x,void clearInterval(i.interval))}).on("touchmove",function(e){return 2==e.targetTouches.length?!1:(h=!0,s={x:e.changedTouches[0].pageX},i.bloom?(o={left:o.left+(s.x-n.x)},t(this).css(o)):(o.left=o.left+(s.x-n.x),t(this).css({left:o.left})),n=s,!1)}).on("touchend",function(o){s={x:o.changedTouches[0].pageX};var a=t(this).position(),c={left:a.left+(s.x-n.x)};t(this).css(c),s.x>e?i.index--:i.index++,i.go(),h=!1,i.auto()}),i.touch(i.num,"i",function(){clearInterval(i.interval),i.index=t(this).index(),i.go(),i.auto()}),t(window).resize(function(){i.setHeightWidth()})},formatNum:function(){if(this.num){for(var t="",i=0,n=this.list.length;n>i;i++){var e=(this.list[i],"");this.index==i&&(e="current"),t+='<i class="'+e+'">'+(i+1)+"</i>"}this.num.html(t)}},go:function(){var t=this,i=t.step;if(this.repeat){var n=-(t.index+1)*i;t.index<0&&(n=0),0==t.index&&(n=-i),t.content.animate({left:n},t.animate,function(){t.index<0&&(t.index=t.list.size()-1,t.content.css("left",-(t.index+1)*i)),t.index>=t.list.size()&&(t.index=0,t.content.css("left",-1*i)),t.formatNum()})}else{t.index<0&&(t.index=0),t.index>=t.size&&(t.index=t.size-1);var n=-t.index*i;t.content.animate({left:n},t.animate,function(){t.formatNum()})}},auto:function(){var t=this;this.interval=setInterval(function(){t.index++,t.repeat||t.index>=t.size&&(t.index=0),t.go()},this.timer)}},i});